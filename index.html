<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>‰∏çÂãïÁî£Â•ëÁ¥ÑÈÄ≤ÊçóÁÆ°ÁêÜÔºà„Çπ„Çø„É≥„Éâ„Ç¢„É≠„É≥Ôºâ</title>

  <!-- React 18 UMD -->
  <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>

  <!-- Babel („Éñ„É©„Ç¶„Ç∂„ÅßJSXÂ§âÊèõÁî®) -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <!-- TailwindCSSÔºàCDNÔºâ -->
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet"/>

  <style>
    body { background: #f7fafc; font-feature-settings: "palt" 1; }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    // ====== lucide-react „ÅÆ‰ª£Êõø:Á∞°ÊòìSVG„Ç¢„Ç§„Ç≥„É≥ ======
    const makeIcon = (label) => ({ className = "w-5 h-5", ...rest }) => (
      <svg
        className={className}
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        strokeWidth="2"
        strokeLinecap="round"
        strokeLinejoin="round"
        aria-label={label}
        {...rest}
      >
        <rect x="3" y="3" width="18" height="18" rx="4" ry="4"></rect>
        <text x="12" y="15" textAnchor="middle" fontSize="8" fontFamily="sans-serif">
          {label?.[0] || "I"}
        </text>
      </svg>
    );

    const Bell = makeIcon('Bell');
    const Plus = makeIcon('Plus');
    const X = makeIcon('X');
    const Calendar = makeIcon('Cal');
    const User = makeIcon('User');
    const Building2 = makeIcon('Bld');
    const AlertCircle = makeIcon('!');
    const Check = makeIcon('OK');
    const Clock = makeIcon('Clk');
    const ChevronRight = makeIcon('>');
    const Users = makeIcon('Usr');
    const MapPin = makeIcon('Pin');
    const Briefcase = makeIcon('Job');
    const DollarSign = makeIcon('¬•');
    const FileText = makeIcon('Doc');
    const Upload = makeIcon('Up');
    const TrendingUp = makeIcon('UpT');
    const BarChart3 = makeIcon('Bar');
    const Search = makeIcon('Srch');
    const Filter = makeIcon('Fltr');
    const Download = makeIcon('DL');
    const Edit2 = makeIcon('Edt');
    const Save = makeIcon('Sav');
    const LayoutDashboard = makeIcon('Dsh');
    const PieChart = makeIcon('Pie');
    const Home = makeIcon('Home');

    // ====== ReactÊú¨‰Ωì ======
    const { useState, useMemo } = React;

    const RealEstateTaskManager = () => {
      const [view, setView] = useState('dashboard');
      const [selectedContract, setSelectedContract] = useState(1);
      const [selectedProperty, setSelectedProperty] = useState(null);
      const [showNewContract, setShowNewContract] = useState(false);
      const [showEditContract, setShowEditContract] = useState(false);
      const [showNewProperty, setShowNewProperty] = useState(false);
      const [showEditProperty, setShowEditProperty] = useState(false);
      const [editingContract, setEditingContract] = useState(null);
      const [editingProperty, setEditingProperty] = useState(null);
      const [editContractTab, setEditContractTab] = useState('basic');
      const [showTaskDetail, setShowTaskDetail] = useState(null);
      const [isEditingTask, setIsEditingTask] = useState(false);
      const [editedTask, setEditedTask] = useState(null);
      const [showPaymentDetail, setShowPaymentDetail] = useState(null);

      const [salesPeriodType, setSalesPeriodType] = useState('month');
      const [salesYear, setSalesYear] = useState(2025);
      const [salesMonth, setSalesMonth] = useState(10);

      const [currentStep, setCurrentStep] = useState(1);
      const [editStep, setEditStep] = useState(1);
      const [propertyStep, setPropertyStep] = useState(1);
      const [editPropertyStep, setEditPropertyStep] = useState(1);
      const totalSteps = 7;
      const totalPropertySteps = 4;

      const [searchQuery, setSearchQuery] = useState('');
      const [priorityFilter, setPriorityFilter] = useState('all');
      const [typeFilter, setTypeFilter] = useState('all');
      const [statusFilter, setStatusFilter] = useState('all');
      const [dateFilter, setDateFilter] = useState('all');
      const [showFilters, setShowFilters] = useState(false);
      const [officeFilter, setOfficeFilter] = useState('all');

      const [showAddOffice, setShowAddOffice] = useState(false);
      const [showAddStaff, setShowAddStaff] = useState(false);

      // üè† Áâ©‰ª∂„Éû„Çπ„Çø„ÅÆstate
      const [properties, setProperties] = useState([
        {
          id: 1,
          propertyType: '„Éû„É≥„Ç∑„Éß„É≥',
          address: 'Êù±‰∫¨ÈÉΩÊ∏ãË∞∑Âå∫Á•ûÂÆÆÂâç1-1-1',
          propertyName: '„Éë„Éº„ÇØ„Éû„É≥„Ç∑„Éß„É≥Ê∏ãË∞∑',
          roomNumber: '305',
          buildingStructure: 'RCÈÄ†',
          buildYear: '2015',
          landArea: '100',
          buildingArea: '80',
          notes: ''
        }
      ]);

      const [newProperty, setNewProperty] = useState({
        propertyType: '„Éû„É≥„Ç∑„Éß„É≥',
        address: '',
        propertyName: '',
        roomNumber: '',
        buildingStructure: '',
        buildYear: '',
        landArea: '',
        buildingArea: '',
        notes: ''
      });

      const [newContract, setNewContract] = useState({
        propertyId: '', // Áâ©‰ª∂„Å®„ÅÆÁ¥ê‰ªò„Åë
        propertyType: '„Éû„É≥„Ç∑„Éß„É≥', address: '', propertyName: '', roomNumber: '',
        dealType: '‰ª≤‰ªã', buyerName: '', buyerKana: '', sellerName: '', sellerKana: '',
        propertyPrice: '', outstandingDebt: '', consumptionTax: '', loanUsage: false,
        loanApprovalDate: '', mortgageRemoval: false, arrears: false, demolition: false,
        renovation: false, survey: false, contractDate: '', settlementDeadline: '',
        confirmedSettlementDate: '', officeId: '', assigneeId: '',
        manualRevenue: '',
        buyerPaymentEnabled: false, buyerPaymentSplit: false,
        buyerPayments: [{ category: '‰ª≤‰ªãÊâãÊï∞Êñô', amount: '', dueDate: '', method: 'ÊåØËæº', receipt: 'ÈÉµÈÄÅ' }],
        sellerPaymentEnabled: false, sellerPaymentSplit: false,
        sellerPayments: [{ category: '‰ª≤‰ªãÊâãÊï∞Êñô', amount: '', dueDate: '', method: 'ÊåØËæº', receipt: 'ÈÉµÈÄÅ' }],
        vendor1PaymentEnabled: false,
        vendor1Payments: [{ category: 'Á¥π‰ªãÊñô', amount: '', dueDate: '', method: 'ÊåØËæº', receipt: 'ÈÉµÈÄÅ' }],
        vendor2PaymentEnabled: false,
        vendor2Payments: [{ category: 'Á¥π‰ªãÊñô', amount: '', dueDate: '', method: 'ÊåØËæº', receipt: 'ÈÉµÈÄÅ' }],
        vendor3PaymentEnabled: false,
        vendor3Payments: [{ category: 'Á¥π‰ªãÊñô', amount: '', dueDate: '', method: 'ÊåØËæº', receipt: 'ÈÉµÈÄÅ' }],
        buyerExpenseEnabled: false,
        buyerExpenses: [{ category: 'ËøîÈáë', amount: '', dueDate: '', accountImages: [] }],
        sellerExpenseEnabled: false,
        sellerExpenses: [{ category: 'Êâã‰ªòÈáë', amount: '', dueDate: '', accountImages: [] }],
        vendor1ExpenseEnabled: false,
        vendor1Expenses: [{ category: '‰ª≤‰ªãÊâãÊï∞Êñô', amount: '', dueDate: '', accountImages: [] }],
        vendor2ExpenseEnabled: false,
        vendor2Expenses: [{ category: '‰ª≤‰ªãÊâãÊï∞Êñô', amount: '', dueDate: '', accountImages: [] }],
        vendor3ExpenseEnabled: false,
        vendor3Expenses: [{ category: '‰ª≤‰ªãÊâãÊï∞Êñô', amount: '', dueDate: '', accountImages: [] }]
      });

      const [contracts, setContracts] = useState([
        {
          id: 1, propertyId: 1, propertyType: '„Éû„É≥„Ç∑„Éß„É≥', address: 'Êù±‰∫¨ÈÉΩÊ∏ãË∞∑Âå∫Á•ûÂÆÆÂâç1-1-1',
          propertyName: '„Éë„Éº„ÇØ„Éû„É≥„Ç∑„Éß„É≥Ê∏ãË∞∑', roomNumber: '305', dealType: '‰ª≤‰ªã',
          buyerName: 'Áî∞‰∏≠Â§™ÈÉé', buyerKana: '„Çø„Éä„Ç´„Çø„É≠„Ç¶', sellerName: 'Â±±Áî∞Ê¨°ÈÉé',
          sellerKana: '„É§„Éû„ÉÄ„Ç∏„É≠„Ç¶', propertyPrice: 50000000, outstandingDebt: 30000000,
          consumptionTax: 0, manualRevenue: 0, loanUsage: true, loanApprovalDate: '2025-11-10',
          mortgageRemoval: true, arrears: false, demolition: false, renovation: true,
          survey: false, contractDate: '2025-10-15', settlementDeadline: '2025-11-30',
          confirmedSettlementDate: '', assigneeId: 1, officeId: 1, status: 'Â•ëÁ¥ÑÊ∫ñÂÇô‰∏≠', progress: 30,
          buyerPayments: [], sellerPayments: [], vendor1Payments: [], vendor2Payments: [], vendor3Payments: [],
          buyerExpenses: [], sellerExpenses: [], vendor1Expenses: [], vendor2Expenses: [], vendor3Expenses: []
        }
      ]);

      const [tasks, setTasks] = useState([
        { id: 1, contractId: 1, propertyId: 1, type: 'ÂÖ•Èáë', title: 'Ë≤∑‰∏ª„Åã„Çâ‰ª≤‰ªãÊâãÊï∞ÊñôÂÖ•Èáë', amount: 1500000, purpose: '‰ª≤‰ªãÊâãÊï∞Êñô', paymentMethod: 'ÊåØËæº', receiptDelivery: 'ÈÉµÈÄÅ', dueDate: '2025-11-30', status: 'pending', assigneeId: 1, priority: 'high', paymentCompleted: false },
        { id: 2, contractId: 1, propertyId: 1, type: 'ÊäµÂΩìÊ®©ÊäπÊ∂à', title: 'ÊäµÂΩìÊ®©ÊäπÊ∂à‰∫ãÂâçÊâãÁ∂ö„Åç', dueDate: '2025-10-30', status: 'in-progress', assigneeId: 1, priority: 'high', paymentCompleted: false },
        { id: 3, contractId: 1, propertyId: 1, type: '„É™„Éï„Ç©„Éº„É†', title: '„É™„Éï„Ç©„Éº„É†Ê•≠ËÄÖ„Å®„ÅÆÊâì„Å°Âêà„Çè„Åõ', dueDate: '2025-11-15', status: 'pending', assigneeId: 1, priority: 'medium', paymentCompleted: false }
      ]);

      const [offices, setOffices] = useState([
        { id: 1, name: 'Ê∏ãË∞∑Âñ∂Ê•≠ÊâÄ', address: 'Êù±‰∫¨ÈÉΩÊ∏ãË∞∑Âå∫„Äá„Äá' },
        { id: 2, name: 'Êñ∞ÂÆøÂñ∂Ê•≠ÊâÄ', address: 'Êù±‰∫¨ÈÉΩÊñ∞ÂÆøÂå∫„Äá„Äá' }
      ]);

      const [staff, setStaff] = useState([
        { id: 1, name: '‰ΩêËó§‰∏ÄÈÉé', officeId: 1, role: 'Âñ∂Ê•≠ÊãÖÂΩì' },
        { id: 2, name: 'Èà¥Êú®Ëä±Â≠ê', officeId: 1, role: 'ÊâÄÈï∑' },
        { id: 3, name: 'È´òÊ©ãÂ§™ÈÉé', officeId: 2, role: 'Âñ∂Ê•≠ÊãÖÂΩì' }
      ]);

      const [newOffice, setNewOffice] = useState({ name: '', address: '' });
      const [newStaff, setNewStaff] = useState({ name: '', officeId: '', role: 'Âñ∂Ê•≠ÊãÖÂΩì' });

      // üè† Áâ©‰ª∂ËøΩÂä†„Éè„É≥„Éâ„É©„Éº
      const handleAddProperty = () => {
        if (!newProperty.address || !newProperty.propertyName) {
          alert('‰ΩèÊâÄ„Å®Áâ©‰ª∂Âêç„ÅØÂøÖÈ†à„Åß„Åô');
          return;
        }
        const property = {
          ...newProperty,
          id: properties.length > 0 ? Math.max(...properties.map(p => p.id)) + 1 : 1
        };
        setProperties([...properties, property]);
        setNewProperty({
          propertyType: '„Éû„É≥„Ç∑„Éß„É≥',
          address: '',
          propertyName: '',
          roomNumber: '',
          buildingStructure: '',
          buildYear: '',
          landArea: '',
          buildingArea: '',
          notes: ''
        });
        setPropertyStep(1);
        setShowNewProperty(false);
        alert('Áâ©‰ª∂„ÇíËøΩÂä†„Åó„Åæ„Åó„Åü');
      };

      // üè† Áâ©‰ª∂Á∑®ÈõÜ„Éè„É≥„Éâ„É©„Éº
      const handleEditProperty = () => {
        if (!editingProperty.address || !editingProperty.propertyName) {
          alert('‰ΩèÊâÄ„Å®Áâ©‰ª∂Âêç„ÅØÂøÖÈ†à„Åß„Åô');
          return;
        }
        setProperties(properties.map(p => p.id === editingProperty.id ? editingProperty : p));
        setEditingProperty(null);
        setEditPropertyStep(1);
        setShowEditProperty(false);
        alert('Áâ©‰ª∂„ÇíÊõ¥Êñ∞„Åó„Åæ„Åó„Åü');
      };

      // üè† Áâ©‰ª∂ÂâäÈô§„Éè„É≥„Éâ„É©„Éº
      const handleDeleteProperty = (id) => {
        if (confirm('„Åì„ÅÆÁâ©‰ª∂„ÇíÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü')) {
          setProperties(properties.filter(p => p.id !== id));
        }
      };

      const handleAddContract = () => {
        if (currentStep < totalSteps) return;
        if (!newContract.address || !newContract.dealType) {
          alert('‰ΩèÊâÄ„Å®ÂèñÂºïÁ®ÆÂà•„ÅØÂøÖÈ†à„Åß„Åô');
          return;
        }
        const contract = {
          ...newContract,
          id: contracts.length > 0 ? Math.max(...contracts.map(c => c.id)) + 1 : 1,
          status: 'Â•ëÁ¥ÑÊ∫ñÂÇô‰∏≠',
          progress: 0
        };
        setContracts([...contracts, contract]);
        setNewContract({
          propertyId: '',
          propertyType: '„Éû„É≥„Ç∑„Éß„É≥', address: '', propertyName: '', roomNumber: '',
          dealType: '‰ª≤‰ªã', buyerName: '', buyerKana: '', sellerName: '', sellerKana: '',
          propertyPrice: '', outstandingDebt: '', consumptionTax: '', loanUsage: false,
          loanApprovalDate: '', mortgageRemoval: false, arrears: false, demolition: false,
          renovation: false, survey: false, contractDate: '', settlementDeadline: '',
          confirmedSettlementDate: '', officeId: '', assigneeId: '',
          manualRevenue: '',
          buyerPaymentEnabled: false, buyerPaymentSplit: false,
          buyerPayments: [{ category: '‰ª≤‰ªãÊâãÊï∞Êñô', amount: '', dueDate: '', method: 'ÊåØËæº', receipt: 'ÈÉµÈÄÅ' }],
          sellerPaymentEnabled: false, sellerPaymentSplit: false,
          sellerPayments: [{ category: '‰ª≤‰ªãÊâãÊï∞Êñô', amount: '', dueDate: '', method: 'ÊåØËæº', receipt: 'ÈÉµÈÄÅ' }],
          vendor1PaymentEnabled: false,
          vendor1Payments: [{ category: 'Á¥π‰ªãÊñô', amount: '', dueDate: '', method: 'ÊåØËæº', receipt: 'ÈÉµÈÄÅ' }],
          vendor2PaymentEnabled: false,
          vendor2Payments: [{ category: 'Á¥π‰ªãÊñô', amount: '', dueDate: '', method: 'ÊåØËæº', receipt: 'ÈÉµÈÄÅ' }],
          vendor3PaymentEnabled: false,
          vendor3Payments: [{ category: 'Á¥π‰ªãÊñô', amount: '', dueDate: '', method: 'ÊåØËæº', receipt: 'ÈÉµÈÄÅ' }],
          buyerExpenseEnabled: false,
          buyerExpenses: [{ category: 'ËøîÈáë', amount: '', dueDate: '', accountImages: [] }],
          sellerExpenseEnabled: false,
          sellerExpenses: [{ category: 'Êâã‰ªòÈáë', amount: '', dueDate: '', accountImages: [] }],
          vendor1ExpenseEnabled: false,
          vendor1Expenses: [{ category: '‰ª≤‰ªãÊâãÊï∞Êñô', amount: '', dueDate: '', accountImages: [] }],
          vendor2ExpenseEnabled: false,
          vendor2Expenses: [{ category: '‰ª≤‰ªãÊâãÊï∞Êñô', amount: '', dueDate: '', accountImages: [] }],
          vendor3ExpenseEnabled: false,
          vendor3Expenses: [{ category: '‰ª≤‰ªãÊâãÊï∞Êñô', amount: '', dueDate: '', accountImages: [] }]
        });
        setCurrentStep(1);
        setShowNewContract(false);
        alert('Â•ëÁ¥Ñ„ÇíËøΩÂä†„Åó„Åæ„Åó„Åü');
      };

      const handleEditContractSave = () => {
        if (!editingContract.address || !editingContract.dealType) {
          alert('‰ΩèÊâÄ„Å®ÂèñÂºïÁ®ÆÂà•„ÅØÂøÖÈ†à„Åß„Åô');
          return;
        }
        setContracts(contracts.map(c => c.id === editingContract.id ? editingContract : c));
        setEditingContract(null);
        setEditStep(1);
        setShowEditContract(false);
        alert('Â•ëÁ¥Ñ„ÇíÊõ¥Êñ∞„Åó„Åæ„Åó„Åü');
      };

      const handleAddOffice = () => {
        if (!newOffice.name || !newOffice.address) {
          alert('Âñ∂Ê•≠ÊâÄÂêç„Å®‰ΩèÊâÄ„ÅØÂøÖÈ†à„Åß„Åô');
          return;
        }
        const office = {
          ...newOffice,
          id: offices.length > 0 ? Math.max(...offices.map(o => o.id)) + 1 : 1
        };
        setOffices([...offices, office]);
        setNewOffice({ name: '', address: '' });
        setShowAddOffice(false);
      };

      const handleAddStaff = () => {
        if (!newStaff.name || !newStaff.officeId) {
          alert('ÂêçÂâç„Å®Âñ∂Ê•≠ÊâÄ„ÅØÂøÖÈ†à„Åß„Åô');
          return;
        }
        const member = {
          ...newStaff,
          officeId: Number(newStaff.officeId),
          id: staff.length > 0 ? Math.max(...staff.map(s => s.id)) + 1 : 1
        };
        setStaff([...staff, member]);
        setNewStaff({ name: '', officeId: '', role: 'Âñ∂Ê•≠ÊãÖÂΩì' });
        setShowAddStaff(false);
      };

      const updateTaskStatus = (taskId, status) => {
        setTasks(tasks.map(t => t.id === taskId ? { ...t, status } : t));
      };

      const handlePaymentComplete = (taskId, taskType) => {
        setTasks(tasks.map(t => t.id === taskId ? { ...t, paymentCompleted: true, status: 'done' } : t));
        setShowPaymentDetail(null);
        alert(`${taskType}„ÇíÁ¢∫Ë™ç„Åó„Åæ„Åó„Åü`);
      };

      const filteredTasks = useMemo(() => {
        let filtered = tasks.filter(task => {
          const contract = contracts.find(c => c.id === task.contractId);
          if (!contract) return false;
          
          // Áâ©‰ª∂„Éï„Ç£„É´„Çø„Éº
          if (selectedProperty && task.propertyId !== selectedProperty) return false;
          
          const office = offices.find(o => o.id === contract.officeId);
          if (officeFilter !== 'all' && contract.officeId !== Number(officeFilter)) return false;
          
          const matchesSearch = task.title.toLowerCase().includes(searchQuery.toLowerCase()) ||
            (contract.propertyName && contract.propertyName.toLowerCase().includes(searchQuery.toLowerCase())) ||
            (contract.address && contract.address.toLowerCase().includes(searchQuery.toLowerCase()));
          if (searchQuery && !matchesSearch) return false;
          
          if (priorityFilter !== 'all' && task.priority !== priorityFilter) return false;
          if (typeFilter !== 'all' && task.type !== typeFilter) return false;
          if (statusFilter !== 'all' && task.status !== statusFilter) return false;
          
          if (dateFilter !== 'all') {
            const today = new Date();
            const dueDate = new Date(task.dueDate);
            const daysDiff = Math.floor((dueDate - today) / (1000 * 60 * 60 * 24));
            if (dateFilter === 'overdue' && daysDiff >= 0) return false;
            if (dateFilter === 'today' && daysDiff !== 0) return false;
            if (dateFilter === 'week' && (daysDiff < 0 || daysDiff > 7)) return false;
            if (dateFilter === 'month' && (daysDiff < 0 || daysDiff > 30)) return false;
          }
          
          return true;
        });
        
        filtered.sort((a, b) => {
          const priorityOrder = { high: 0, medium: 1, low: 2 };
          if (a.priority !== b.priority) {
            return priorityOrder[a.priority] - priorityOrder[b.priority];
          }
          return new Date(a.dueDate) - new Date(b.dueDate);
        });
        
        return filtered;
      }, [tasks, searchQuery, priorityFilter, typeFilter, statusFilter, dateFilter, contracts, officeFilter, offices, selectedProperty]);

      const taskStats = useMemo(() => {
        const pending = tasks.filter(t => t.status === 'pending').length;
        const inProgress = tasks.filter(t => t.status === 'in-progress').length;
        const done = tasks.filter(t => t.status === 'done').length;
        const overdue = tasks.filter(t => {
          const today = new Date();
          const dueDate = new Date(t.dueDate);
          return t.status !== 'done' && dueDate < today;
        }).length;
        return { pending, inProgress, done, overdue, total: tasks.length };
      }, [tasks]);

      // „Çµ„Ç§„Éâ„Éê„Éº„ÅÆ„Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥
      const navigation = [
        { id: 'dashboard', label: '„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ', icon: LayoutDashboard },
        { id: 'properties', label: 'Áâ©‰ª∂‰∏ÄË¶ß', icon: Home },
        { id: 'contracts', label: 'Â•ëÁ¥ÑÁÆ°ÁêÜ', icon: FileText },
        { id: 'tasks', label: '„Çø„Çπ„ÇØÁÆ°ÁêÜ', icon: Clock },
        { id: 'offices', label: 'Âñ∂Ê•≠ÊâÄÁÆ°ÁêÜ', icon: Building2 },
        { id: 'staff', label: '„Çπ„Çø„ÉÉ„ÉïÁÆ°ÁêÜ', icon: Users }
      ];

      return (
        <div className="flex h-screen bg-gray-50">
          {/* „Çµ„Ç§„Éâ„Éê„Éº */}
          <div className="w-64 bg-gradient-to-b from-orange-600 to-orange-700 text-white flex flex-col shadow-xl">
            <div className="p-6 border-b border-orange-500">
              <h1 className="text-xl font-bold">‰∏çÂãïÁî£Â•ëÁ¥ÑÁÆ°ÁêÜ</h1>
              <p className="text-orange-100 text-sm mt-1">ÈÄ≤ÊçóÁÆ°ÁêÜ„Ç∑„Çπ„ÉÜ„É†</p>
            </div>
            
            <nav className="flex-1 p-4 space-y-2 overflow-y-auto">
              {navigation.map(item => {
                const Icon = item.icon;
                return (
                  <button
                    key={item.id}
                    onClick={() => {
                      setView(item.id);
                      setSelectedProperty(null); // Áâ©‰ª∂„Éï„Ç£„É´„Çø„Éº„Çí„É™„Çª„ÉÉ„Éà
                    }}
                    className={`w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-all ${
                      view === item.id
                        ? 'bg-white text-orange-600 shadow-lg font-semibold'
                        : 'text-orange-100 hover:bg-orange-500 hover:text-white'
                    }`}
                  >
                    <Icon className="w-5 h-5" />
                    <span>{item.label}</span>
                  </button>
                );
              })}
            </nav>

            <div className="p-4 border-t border-orange-500">
              <div className="flex items-center space-x-3 px-4 py-3">
                <User className="w-5 h-5" />
                <span className="text-sm">ÁÆ°ÁêÜËÄÖ</span>
              </div>
            </div>
          </div>

          {/* „É°„Ç§„É≥„Ç≥„É≥„ÉÜ„É≥„ÉÑ */}
          <div className="flex-1 overflow-auto">
            {/* „ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ */}
            {view === 'dashboard' && (
              <div className="p-8 space-y-6">
                <div className="flex justify-between items-center">
                  <h2 className="text-3xl font-bold text-gray-800">„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ</h2>
                </div>

                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                  <div className="bg-white rounded-xl p-6 shadow-md border-l-4 border-blue-500">
                    <div className="flex items-center justify-between">
                      <div>
                        <p className="text-gray-500 text-sm font-medium">Êú™ÁùÄÊâã</p>
                        <p className="text-3xl font-bold text-gray-800 mt-2">{taskStats.pending}</p>
                      </div>
                      <div className="bg-blue-100 p-3 rounded-full">
                        <Clock className="w-6 h-6 text-blue-600" />
                      </div>
                    </div>
                  </div>

                  <div className="bg-white rounded-xl p-6 shadow-md border-l-4 border-yellow-500">
                    <div className="flex items-center justify-between">
                      <div>
                        <p className="text-gray-500 text-sm font-medium">ÈÄ≤Ë°å‰∏≠</p>
                        <p className="text-3xl font-bold text-gray-800 mt-2">{taskStats.inProgress}</p>
                      </div>
                      <div className="bg-yellow-100 p-3 rounded-full">
                        <TrendingUp className="w-6 h-6 text-yellow-600" />
                      </div>
                    </div>
                  </div>

                  <div className="bg-white rounded-xl p-6 shadow-md border-l-4 border-green-500">
                    <div className="flex items-center justify-between">
                      <div>
                        <p className="text-gray-500 text-sm font-medium">ÂÆå‰∫Ü</p>
                        <p className="text-3xl font-bold text-gray-800 mt-2">{taskStats.done}</p>
                      </div>
                      <div className="bg-green-100 p-3 rounded-full">
                        <Check className="w-6 h-6 text-green-600" />
                      </div>
                    </div>
                  </div>

                  <div className="bg-white rounded-xl p-6 shadow-md border-l-4 border-red-500">
                    <div className="flex items-center justify-between">
                      <div>
                        <p className="text-gray-500 text-sm font-medium">ÊúüÈôêË∂ÖÈÅé</p>
                        <p className="text-3xl font-bold text-gray-800 mt-2">{taskStats.overdue}</p>
                      </div>
                      <div className="bg-red-100 p-3 rounded-full">
                        <AlertCircle className="w-6 h-6 text-red-600" />
                      </div>
                    </div>
                  </div>
                </div>

                <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                  <div className="bg-white rounded-xl p-6 shadow-md">
                    <h3 className="text-xl font-bold text-gray-800 mb-4">Â•ëÁ¥ÑÁä∂Ê≥Å</h3>
                    <div className="space-y-3">
                      <div className="flex justify-between items-center">
                        <span className="text-gray-600">Á∑èÂ•ëÁ¥ÑÊï∞</span>
                        <span className="font-bold text-gray-800">{contracts.length}‰ª∂</span>
                      </div>
                      <div className="flex justify-between items-center">
                        <span className="text-gray-600">ÈÄ≤Ë°å‰∏≠</span>
                        <span className="font-bold text-blue-600">
                          {contracts.filter(c => c.status === 'Â•ëÁ¥ÑÊ∫ñÂÇô‰∏≠' || c.status === 'Ê±∫Ê∏àÊ∫ñÂÇô‰∏≠').length}‰ª∂
                        </span>
                      </div>
                    </div>
                  </div>

                  <div className="bg-white rounded-xl p-6 shadow-md">
                    <h3 className="text-xl font-bold text-gray-800 mb-4">Áâ©‰ª∂Áä∂Ê≥Å</h3>
                    <div className="space-y-3">
                      <div className="flex justify-between items-center">
                        <span className="text-gray-600">ÁôªÈå≤Áâ©‰ª∂Êï∞</span>
                        <span className="font-bold text-gray-800">{properties.length}‰ª∂</span>
                      </div>
                      <div className="flex justify-between items-center">
                        <span className="text-gray-600">Â•ëÁ¥ÑÊ∏àÁâ©‰ª∂</span>
                        <span className="font-bold text-green-600">
                          {properties.filter(p => contracts.some(c => c.propertyId === p.id)).length}‰ª∂
                        </span>
                      </div>
                    </div>
                  </div>
                </div>

                <div className="bg-white rounded-xl p-6 shadow-md">
                  <h3 className="text-xl font-bold text-gray-800 mb-4">Áõ¥Ëøë„ÅÆ„Çø„Çπ„ÇØ</h3>
                  <div className="space-y-3">
                    {filteredTasks.slice(0, 5).map(task => {
                      const contract = contracts.find(c => c.id === task.contractId);
                      const property = properties.find(p => p.id === task.propertyId);
                      return (
                        <div key={task.id} className="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                          <div className="flex-1">
                            <div className="font-semibold text-gray-800">{task.title}</div>
                            <div className="text-sm text-gray-500 mt-1">
                              {property ? `${property.propertyName} ${property.roomNumber || ''}` : 'Áâ©‰ª∂ÊÉÖÂ†±„Å™„Åó'}
                            </div>
                          </div>
                          <div className="text-sm text-gray-600">{task.dueDate}</div>
                        </div>
                      );
                    })}
                  </div>
                </div>
              </div>
            )}

            {/* üè† Áâ©‰ª∂‰∏ÄË¶ß */}
            {view === 'properties' && (
              <div className="p-8 space-y-6">
                <div className="flex justify-between items-center">
                  <h2 className="text-3xl font-bold text-gray-800">Áâ©‰ª∂‰∏ÄË¶ß</h2>
                  <button
                    onClick={() => setShowNewProperty(true)}
                    className="bg-orange-500 text-white px-6 py-3 rounded-lg font-semibold hover:bg-orange-600 transition-colors flex items-center space-x-2 shadow-lg"
                  >
                    <Plus className="w-5 h-5" />
                    <span>Áâ©‰ª∂„ÇíËøΩÂä†</span>
                  </button>
                </div>

                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                  {properties.map(property => {
                    const relatedContracts = contracts.filter(c => c.propertyId === property.id);
                    const relatedTasks = tasks.filter(t => t.propertyId === property.id);
                    const pendingTasks = relatedTasks.filter(t => t.status === 'pending' || t.status === 'in-progress');
                    
                    return (
                      <div key={property.id} className="bg-white rounded-xl shadow-md overflow-hidden hover:shadow-xl transition-shadow">
                        <div className="bg-gradient-to-r from-orange-500 to-orange-600 p-4">
                          <div className="flex items-start justify-between">
                            <div className="flex-1">
                              <div className="text-white font-bold text-lg">{property.propertyName}</div>
                              <div className="text-orange-100 text-sm mt-1">{property.roomNumber}</div>
                            </div>
                            <div className="bg-white bg-opacity-20 px-3 py-1 rounded-full text-white text-sm">
                              {property.propertyType}
                            </div>
                          </div>
                        </div>

                        <div className="p-4 space-y-3">
                          <div className="flex items-start space-x-2">
                            <MapPin className="w-4 h-4 text-gray-400 mt-1 flex-shrink-0" />
                            <div className="text-sm text-gray-600">{property.address}</div>
                          </div>

                          {property.buildingStructure && (
                            <div className="text-sm text-gray-600">
                              <span className="font-semibold">ÊßãÈÄ†Ôºö</span>{property.buildingStructure}
                            </div>
                          )}

                          {property.buildYear && (
                            <div className="text-sm text-gray-600">
                              <span className="font-semibold">ÁØâÂπ¥Ôºö</span>{property.buildYear}Âπ¥
                            </div>
                          )}

                          <div className="pt-3 border-t border-gray-200">
                            <div className="flex items-center justify-between text-sm">
                              <span className="text-gray-600">Èñ¢ÈÄ£Â•ëÁ¥Ñ</span>
                              <span className="font-bold text-gray-800">{relatedContracts.length}‰ª∂</span>
                            </div>
                            <div className="flex items-center justify-between text-sm mt-2">
                              <span className="text-gray-600">ÈÄ≤Ë°å‰∏≠„Çø„Çπ„ÇØ</span>
                              <span className="font-bold text-orange-600">{pendingTasks.length}‰ª∂</span>
                            </div>
                          </div>

                          <div className="flex space-x-2 pt-3">
                            <button
                              onClick={() => {
                                setSelectedProperty(property.id);
                                setView('tasks');
                              }}
                              className="flex-1 bg-blue-500 text-white py-2 rounded-lg text-sm font-semibold hover:bg-blue-600 transition-colors"
                            >
                              „Çø„Çπ„ÇØË°®Á§∫
                            </button>
                            <button
                              onClick={() => {
                                setEditingProperty(property);
                                setShowEditProperty(true);
                              }}
                              className="flex-1 bg-gray-500 text-white py-2 rounded-lg text-sm font-semibold hover:bg-gray-600 transition-colors"
                            >
                              Á∑®ÈõÜ
                            </button>
                            <button
                              onClick={() => handleDeleteProperty(property.id)}
                              className="bg-red-500 text-white px-4 py-2 rounded-lg text-sm font-semibold hover:bg-red-600 transition-colors"
                            >
                              ÂâäÈô§
                            </button>
                          </div>
                        </div>
                      </div>
                    );
                  })}
                </div>

                {properties.length === 0 && (
                  <div className="bg-white rounded-xl p-12 text-center shadow-md">
                    <Home className="w-16 h-16 text-gray-300 mx-auto mb-4" />
                    <p className="text-gray-500 text-lg">Áâ©‰ª∂„ÅåÁôªÈå≤„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì</p>
                    <p className="text-gray-400 text-sm mt-2">„ÄåÁâ©‰ª∂„ÇíËøΩÂä†„Äç„Éú„Çø„É≥„Åã„ÇâÁôªÈå≤„Åó„Å¶„Åè„Å†„Åï„ÅÑ</p>
                  </div>
                )}
              </div>
            )}

            {/* Â•ëÁ¥ÑÁÆ°ÁêÜ */}
            {view === 'contracts' && (
              <div className="p-8 space-y-6">
                <div className="flex justify-between items-center">
                  <h2 className="text-3xl font-bold text-gray-800">Â•ëÁ¥ÑÁÆ°ÁêÜ</h2>
                  <button
                    onClick={() => setShowNewContract(true)}
                    className="bg-orange-500 text-white px-6 py-3 rounded-lg font-semibold hover:bg-orange-600 transition-colors flex items-center space-x-2 shadow-lg"
                  >
                    <Plus className="w-5 h-5" />
                    <span>Â•ëÁ¥Ñ„ÇíËøΩÂä†</span>
                  </button>
                </div>

                <div className="space-y-4">
                  {contracts.map(contract => {
                    const assignee = staff.find(s => s.id === contract.assigneeId);
                    const office = offices.find(o => o.id === contract.officeId);
                    const property = properties.find(p => p.id === contract.propertyId);
                    
                    return (
                      <div key={contract.id} className="bg-white rounded-xl shadow-md p-6 hover:shadow-lg transition-shadow">
                        <div className="flex items-start justify-between">
                          <div className="flex-1">
                            <div className="flex items-center space-x-3 mb-2">
                              <h3 className="text-xl font-bold text-gray-800">
                                {contract.propertyName} {contract.roomNumber}
                              </h3>
                              <span className="px-3 py-1 bg-orange-100 text-orange-600 rounded-full text-sm font-semibold">
                                {contract.dealType}
                              </span>
                              {property && (
                                <span className="px-3 py-1 bg-blue-100 text-blue-600 rounded-full text-sm font-semibold">
                                  Áâ©‰ª∂ID: {property.id}
                                </span>
                              )}
                            </div>
                            <p className="text-gray-600">{contract.address}</p>
                            <div className="flex items-center space-x-4 mt-3 text-sm text-gray-500">
                              <span>Ë≤∑‰∏ª: {contract.buyerName}</span>
                              <span>Â£≤‰∏ª: {contract.sellerName}</span>
                              {assignee && <span>ÊãÖÂΩì: {assignee.name}</span>}
                              {office && <span>Âñ∂Ê•≠ÊâÄ: {office.name}</span>}
                            </div>
                          </div>
                          <button
                            onClick={() => {
                              setEditingContract(contract);
                              setShowEditContract(true);
                            }}
                            className="bg-blue-500 text-white px-4 py-2 rounded-lg font-semibold hover:bg-blue-600 transition-colors flex items-center space-x-2"
                          >
                            <Edit2 className="w-4 h-4" />
                            <span>Á∑®ÈõÜ</span>
                          </button>
                        </div>

                        <div className="mt-4 pt-4 border-t border-gray-200">
                          <div className="grid grid-cols-3 gap-4 text-sm">
                            <div>
                              <span className="text-gray-500">Â•ëÁ¥ÑÊó•:</span>
                              <span className="ml-2 font-semibold">{contract.contractDate}</span>
                            </div>
                            <div>
                              <span className="text-gray-500">Ê±∫Ê∏àÊúüÈôê:</span>
                              <span className="ml-2 font-semibold">{contract.settlementDeadline}</span>
                            </div>
                            <div>
                              <span className="text-gray-500">Áâ©‰ª∂‰æ°Ê†º:</span>
                              <span className="ml-2 font-semibold">{Number(contract.propertyPrice).toLocaleString()}ÂÜÜ</span>
                            </div>
                          </div>
                        </div>
                      </div>
                    );
                  })}
                </div>

                {contracts.length === 0 && (
                  <div className="bg-white rounded-xl p-12 text-center shadow-md">
                    <FileText className="w-16 h-16 text-gray-300 mx-auto mb-4" />
                    <p className="text-gray-500 text-lg">Â•ëÁ¥Ñ„ÅåÁôªÈå≤„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì</p>
                    <p className="text-gray-400 text-sm mt-2">„ÄåÂ•ëÁ¥Ñ„ÇíËøΩÂä†„Äç„Éú„Çø„É≥„Åã„ÇâÁôªÈå≤„Åó„Å¶„Åè„Å†„Åï„ÅÑ</p>
                  </div>
                )}
              </div>
            )}

            {/* „Çø„Çπ„ÇØÁÆ°ÁêÜ */}
            {view === 'tasks' && (
              <div className="p-8 space-y-6">
                <div className="flex justify-between items-center">
                  <div>
                    <h2 className="text-3xl font-bold text-gray-800">„Çø„Çπ„ÇØÁÆ°ÁêÜ</h2>
                    {selectedProperty && (
                      <p className="text-gray-600 mt-2">
                        {properties.find(p => p.id === selectedProperty)?.propertyName} „ÅÆ„Çø„Çπ„ÇØ
                        <button
                          onClick={() => setSelectedProperty(null)}
                          className="ml-4 text-sm text-orange-500 hover:text-orange-600 underline"
                        >
                          „Éï„Ç£„É´„Çø„ÉºËß£Èô§
                        </button>
                      </p>
                    )}
                  </div>
                  <button
                    onClick={() => setShowFilters(!showFilters)}
                    className="bg-gray-500 text-white px-6 py-3 rounded-lg font-semibold hover:bg-gray-600 transition-colors flex items-center space-x-2"
                  >
                    <Filter className="w-5 h-5" />
                    <span>„Éï„Ç£„É´„Çø„Éº</span>
                  </button>
                </div>

                {showFilters && (
                  <div className="bg-white rounded-xl p-6 shadow-md space-y-4">
                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                      <div>
                        <label className="block text-sm font-semibold text-gray-700 mb-2">Ê§úÁ¥¢</label>
                        <input
                          type="text"
                          value={searchQuery}
                          onChange={(e) => setSearchQuery(e.target.value)}
                          placeholder="„Çø„Çπ„ÇØ„ÇíÊ§úÁ¥¢..."
                          className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                        />
                      </div>

                      <div>
                        <label className="block text-sm font-semibold text-gray-700 mb-2">ÂÑ™ÂÖàÂ∫¶</label>
                        <select
                          value={priorityFilter}
                          onChange={(e) => setPriorityFilter(e.target.value)}
                          className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                        >
                          <option value="all">„Åô„Åπ„Å¶</option>
                          <option value="high">È´ò</option>
                          <option value="medium">‰∏≠</option>
                          <option value="low">‰Ωé</option>
                        </select>
                      </div>

                      <div>
                        <label className="block text-sm font-semibold text-gray-700 mb-2">„Çø„Çπ„ÇØÁ®ÆÂà•</label>
                        <select
                          value={typeFilter}
                          onChange={(e) => setTypeFilter(e.target.value)}
                          className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                        >
                          <option value="all">„Åô„Åπ„Å¶</option>
                          <option value="ÂÖ•Èáë">ÂÖ•Èáë</option>
                          <option value="ÊîØÊâï„ÅÑ">ÊîØÊâï„ÅÑ</option>
                          <option value="ÊäµÂΩìÊ®©ÊäπÊ∂à">ÊäµÂΩìÊ®©ÊäπÊ∂à</option>
                          <option value="„É™„Éï„Ç©„Éº„É†">„É™„Éï„Ç©„Éº„É†</option>
                        </select>
                      </div>

                      <div>
                        <label className="block text-sm font-semibold text-gray-700 mb-2">„Çπ„ÉÜ„Éº„Çø„Çπ</label>
                        <select
                          value={statusFilter}
                          onChange={(e) => setStatusFilter(e.target.value)}
                          className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                        >
                          <option value="all">„Åô„Åπ„Å¶</option>
                          <option value="pending">Êú™ÁùÄÊâã</option>
                          <option value="in-progress">ÈÄ≤Ë°å‰∏≠</option>
                          <option value="done">ÂÆå‰∫Ü</option>
                        </select>
                      </div>
                    </div>
                  </div>
                )}

                <div className="space-y-4">
                  {filteredTasks.map(task => {
                    const contract = contracts.find(c => c.id === task.contractId);
                    const property = properties.find(p => p.id === task.propertyId);
                    const assignee = staff.find(s => s.id === task.assigneeId);

                    const statusConfig = {
                      pending: { bg: 'bg-gray-100', text: 'text-gray-600', label: 'Êú™ÁùÄÊâã' },
                      'in-progress': { bg: 'bg-blue-100', text: 'text-blue-600', label: 'ÈÄ≤Ë°å‰∏≠' },
                      done: { bg: 'bg-green-100', text: 'text-green-600', label: 'ÂÆå‰∫Ü' }
                    };

                    const priorityConfig = {
                      high: { bg: 'bg-red-100', text: 'text-red-600', label: 'È´ò' },
                      medium: { bg: 'bg-yellow-100', text: 'text-yellow-600', label: '‰∏≠' },
                      low: { bg: 'bg-gray-100', text: 'text-gray-600', label: '‰Ωé' }
                    };

                    const status = statusConfig[task.status];
                    const priority = priorityConfig[task.priority];

                    return (
                      <div
                        key={task.id}
                        className="bg-white rounded-xl shadow-md p-6 hover:shadow-lg transition-shadow cursor-pointer"
                        onClick={() => {
                          if (task.type === 'ÂÖ•Èáë' || task.type === 'ÊîØÊâï„ÅÑ') {
                            setShowPaymentDetail(task);
                          } else {
                            setShowTaskDetail(task);
                          }
                        }}
                      >
                        <div className="flex items-start justify-between">
                          <div className="flex-1">
                            <div className="flex items-center space-x-3 mb-2">
                              <h3 className="text-lg font-bold text-gray-800">{task.title}</h3>
                              <span className={`px-3 py-1 ${status.bg} ${status.text} rounded-full text-sm font-semibold`}>
                                {status.label}
                              </span>
                              <span className={`px-3 py-1 ${priority.bg} ${priority.text} rounded-full text-sm font-semibold`}>
                                ÂÑ™ÂÖàÂ∫¶: {priority.label}
                              </span>
                            </div>

                            {property && (
                              <p className="text-gray-600 text-sm mb-2">
                                {property.propertyName} {property.roomNumber}
                              </p>
                            )}

                            <div className="flex items-center space-x-4 text-sm text-gray-500">
                              <span className="flex items-center space-x-1">
                                <Calendar className="w-4 h-4" />
                                <span>ÊúüÊó•: {task.dueDate}</span>
                              </span>
                              {assignee && (
                                <span className="flex items-center space-x-1">
                                  <User className="w-4 h-4" />
                                  <span>ÊãÖÂΩì: {assignee.name}</span>
                                </span>
                              )}
                              <span className="flex items-center space-x-1">
                                <FileText className="w-4 h-4" />
                                <span>Á®ÆÂà•: {task.type}</span>
                              </span>
                            </div>

                            {task.amount && (
                              <div className="mt-3 pt-3 border-t border-gray-200">
                                <span className="text-sm text-gray-500">ÈáëÈ°ç: </span>
                                <span className="text-lg font-bold text-gray-800">
                                  {Number(task.amount).toLocaleString()}ÂÜÜ
                                </span>
                              </div>
                            )}
                          </div>

                          <ChevronRight className="w-6 h-6 text-gray-400" />
                        </div>
                      </div>
                    );
                  })}
                </div>

                {filteredTasks.length === 0 && (
                  <div className="bg-white rounded-xl p-12 text-center shadow-md">
                    <Clock className="w-16 h-16 text-gray-300 mx-auto mb-4" />
                    <p className="text-gray-500 text-lg">Ë©≤ÂΩì„Åô„Çã„Çø„Çπ„ÇØ„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</p>
                  </div>
                )}
              </div>
            )}

            {/* Âñ∂Ê•≠ÊâÄÁÆ°ÁêÜ */}
            {view === 'offices' && (
              <div className="p-8 space-y-6">
                <div className="flex justify-between items-center">
                  <h2 className="text-3xl font-bold text-gray-800">Âñ∂Ê•≠ÊâÄÁÆ°ÁêÜ</h2>
                  <button
                    onClick={() => setShowAddOffice(true)}
                    className="bg-orange-500 text-white px-6 py-3 rounded-lg font-semibold hover:bg-orange-600 transition-colors flex items-center space-x-2 shadow-lg"
                  >
                    <Plus className="w-5 h-5" />
                    <span>Âñ∂Ê•≠ÊâÄ„ÇíËøΩÂä†</span>
                  </button>
                </div>

                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                  {offices.map(office => {
                    const officeStaff = staff.filter(s => s.officeId === office.id);
                    const officeContracts = contracts.filter(c => c.officeId === office.id);

                    return (
                      <div key={office.id} className="bg-white rounded-xl shadow-md p-6">
                        <div className="flex items-start justify-between mb-4">
                          <div>
                            <h3 className="text-xl font-bold text-gray-800">{office.name}</h3>
                            <p className="text-gray-600 text-sm mt-1">{office.address}</p>
                          </div>
                          <Building2 className="w-8 h-8 text-orange-500" />
                        </div>

                        <div className="space-y-3 pt-4 border-t border-gray-200">
                          <div className="flex items-center justify-between">
                            <span className="text-gray-600">„Çπ„Çø„ÉÉ„ÉïÊï∞</span>
                            <span className="font-bold text-gray-800">{officeStaff.length}Âêç</span>
                          </div>
                          <div className="flex items-center justify-between">
                            <span className="text-gray-600">ÈÄ≤Ë°å‰∏≠„ÅÆÂ•ëÁ¥Ñ</span>
                            <span className="font-bold text-orange-600">{officeContracts.length}‰ª∂</span>
                          </div>
                        </div>
                      </div>
                    );
                  })}
                </div>
              </div>
            )}

            {/* „Çπ„Çø„ÉÉ„ÉïÁÆ°ÁêÜ */}
            {view === 'staff' && (
              <div className="p-8 space-y-6">
                <div className="flex justify-between items-center">
                  <h2 className="text-3xl font-bold text-gray-800">„Çπ„Çø„ÉÉ„ÉïÁÆ°ÁêÜ</h2>
                  <button
                    onClick={() => setShowAddStaff(true)}
                    className="bg-orange-500 text-white px-6 py-3 rounded-lg font-semibold hover:bg-orange-600 transition-colors flex items-center space-x-2 shadow-lg"
                  >
                    <Plus className="w-5 h-5" />
                    <span>„Çπ„Çø„ÉÉ„Éï„ÇíËøΩÂä†</span>
                  </button>
                </div>

                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                  {staff.map(member => {
                    const office = offices.find(o => o.id === member.officeId);
                    const memberContracts = contracts.filter(c => c.assigneeId === member.id);

                    return (
                      <div key={member.id} className="bg-white rounded-xl shadow-md p-6">
                        <div className="flex items-start justify-between mb-4">
                          <div>
                            <h3 className="text-xl font-bold text-gray-800">{member.name}</h3>
                            <p className="text-gray-600 text-sm mt-1">{member.role}</p>
                            {office && <p className="text-gray-500 text-sm">{office.name}</p>}
                          </div>
                          <User className="w-8 h-8 text-blue-500" />
                        </div>

                        <div className="pt-4 border-t border-gray-200">
                          <div className="flex items-center justify-between">
                            <span className="text-gray-600">ÊãÖÂΩìÂ•ëÁ¥ÑÊï∞</span>
                            <span className="font-bold text-gray-800">{memberContracts.length}‰ª∂</span>
                          </div>
                        </div>
                      </div>
                    );
                  })}
                </div>
              </div>
            )}
          </div>

          {/* üè† Áâ©‰ª∂ËøΩÂä†„É¢„Éº„ÉÄ„É´ */}
          {showNewProperty && (
            <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
              <div className="bg-white rounded-2xl shadow-2xl w-full max-w-3xl max-h-[90vh] overflow-y-auto">
                <div className="sticky top-0 bg-white border-b p-6 z-10">
                  <div className="flex items-center justify-between">
                    <div>
                      <h3 className="text-2xl font-bold text-gray-800">Áâ©‰ª∂„ÇíËøΩÂä†</h3>
                      <p className="text-sm text-gray-500 mt-1">
                        „Çπ„ÉÜ„ÉÉ„Éó {propertyStep} / {totalPropertySteps}
                      </p>
                    </div>
                    <button onClick={() => { setShowNewProperty(false); setPropertyStep(1); }} className="text-gray-400 hover:text-gray-600">
                      <X className="w-6 h-6" />
                    </button>
                  </div>
                  <div className="mt-4 flex space-x-2">
                    {[1, 2, 3, 4].map(step => (
                      <div
                        key={step}
                        className={`flex-1 h-2 rounded-full ${step <= propertyStep ? 'bg-orange-500' : 'bg-gray-200'}`}
                      />
                    ))}
                  </div>
                </div>

                <div className="p-6 space-y-6">
                  {propertyStep === 1 && (
                    <div className="space-y-4">
                      <h4 className="text-lg font-bold text-gray-800">Âü∫Êú¨ÊÉÖÂ†±</h4>
                      <div>
                        <label className="block text-sm font-semibold text-gray-700 mb-2">Áâ©‰ª∂Á®ÆÂà• *</label>
                        <select
                          value={newProperty.propertyType}
                          onChange={(e) => setNewProperty({ ...newProperty, propertyType: e.target.value })}
                          className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                        >
                          <option>„Éû„É≥„Ç∑„Éß„É≥</option>
                          <option>‰∏ÄÊà∏Âª∫„Å¶</option>
                          <option>ÂúüÂú∞</option>
                          <option>Â∫óËàó„Éª‰∫ãÂãôÊâÄ</option>
                        </select>
                      </div>
                      <div>
                        <label className="block text-sm font-semibold text-gray-700 mb-2">Áâ©‰ª∂Âêç *</label>
                        <input
                          type="text"
                          value={newProperty.propertyName}
                          onChange={(e) => setNewProperty({ ...newProperty, propertyName: e.target.value })}
                          placeholder="‰æã: „Éë„Éº„ÇØ„Éû„É≥„Ç∑„Éß„É≥Ê∏ãË∞∑"
                          className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                        />
                      </div>
                    </div>
                  )}

                  {propertyStep === 2 && (
                    <div className="space-y-4">
                      <h4 className="text-lg font-bold text-gray-800">ÊâÄÂú®Âú∞ÊÉÖÂ†±</h4>
                      <div>
                        <label className="block text-sm font-semibold text-gray-700 mb-2">‰ΩèÊâÄ *</label>
                        <input
                          type="text"
                          value={newProperty.address}
                          onChange={(e) => setNewProperty({ ...newProperty, address: e.target.value })}
                          placeholder="‰æã: Êù±‰∫¨ÈÉΩÊ∏ãË∞∑Âå∫Á•ûÂÆÆÂâç1-1-1"
                          className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                        />
                      </div>
                      {newProperty.propertyType === '„Éû„É≥„Ç∑„Éß„É≥' && (
                        <div>
                          <label className="block text-sm font-semibold text-gray-700 mb-2">ÈÉ®Â±ãÁï™Âè∑</label>
                          <input
                            type="text"
                            value={newProperty.roomNumber}
                            onChange={(e) => setNewProperty({ ...newProperty, roomNumber: e.target.value })}
                            placeholder="‰æã: 305"
                            className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                          />
                        </div>
                      )}
                    </div>
                  )}

                  {propertyStep === 3 && (
                    <div className="space-y-4">
                      <h4 className="text-lg font-bold text-gray-800">Áâ©‰ª∂Ë©≥Á¥∞</h4>
                      <div>
                        <label className="block text-sm font-semibold text-gray-700 mb-2">Âª∫Áâ©ÊßãÈÄ†</label>
                        <select
                          value={newProperty.buildingStructure}
                          onChange={(e) => setNewProperty({ ...newProperty, buildingStructure: e.target.value })}
                          className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                        >
                          <option value="">ÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ</option>
                          <option>Êú®ÈÄ†</option>
                          <option>ÈâÑÈ™®ÈÄ†</option>
                          <option>RCÈÄ†</option>
                          <option>SRCÈÄ†</option>
                        </select>
                      </div>
                      <div>
                        <label className="block text-sm font-semibold text-gray-700 mb-2">ÁØâÂπ¥</label>
                        <input
                          type="text"
                          value={newProperty.buildYear}
                          onChange={(e) => setNewProperty({ ...newProperty, buildYear: e.target.value })}
                          placeholder="‰æã: 2015"
                          className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                        />
                      </div>
                      <div className="grid grid-cols-2 gap-4">
                        <div>
                          <label className="block text-sm font-semibold text-gray-700 mb-2">ÂúüÂú∞Èù¢Á©ç („é°)</label>
                          <input
                            type="text"
                            value={newProperty.landArea}
                            onChange={(e) => setNewProperty({ ...newProperty, landArea: e.target.value })}
                            placeholder="‰æã: 100"
                            className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                          />
                        </div>
                        <div>
                          <label className="block text-sm font-semibold text-gray-700 mb-2">Âª∫Áâ©Èù¢Á©ç („é°)</label>
                          <input
                            type="text"
                            value={newProperty.buildingArea}
                            onChange={(e) => setNewProperty({ ...newProperty, buildingArea: e.target.value })}
                            placeholder="‰æã: 80"
                            className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                          />
                        </div>
                      </div>
                    </div>
                  )}

                  {propertyStep === 4 && (
                    <div className="space-y-4">
                      <h4 className="text-lg font-bold text-gray-800">ÂÇôËÄÉ</h4>
                      <div>
                        <label className="block text-sm font-semibold text-gray-700 mb-2">ÂÇôËÄÉ„Éª„É°„É¢</label>
                        <textarea
                          value={newProperty.notes}
                          onChange={(e) => setNewProperty({ ...newProperty, notes: e.target.value })}
                          placeholder="Áâ©‰ª∂„Å´Èñ¢„Åô„ÇãË£úË∂≥ÊÉÖÂ†±„ÇíË®òÂÖ•„Åó„Å¶„Åè„Å†„Åï„ÅÑ"
                          rows="6"
                          className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                        />
                      </div>
                    </div>
                  )}
                </div>

                <div className="sticky bottom-0 bg-gray-50 px-6 py-4 flex justify-between border-t">
                  {propertyStep > 1 && (
                    <button
                      onClick={() => setPropertyStep(propertyStep - 1)}
                      className="px-6 py-2 border border-gray-300 rounded-lg font-semibold text-gray-700 hover:bg-gray-100 transition-colors"
                    >
                      Êàª„Çã
                    </button>
                  )}
                  {propertyStep < totalPropertySteps && (
                    <button
                      onClick={() => setPropertyStep(propertyStep + 1)}
                      className="ml-auto px-6 py-2 bg-orange-500 text-white rounded-lg font-semibold hover:bg-orange-600 transition-colors"
                    >
                      Ê¨°„Å∏
                    </button>
                  )}
                  {propertyStep === totalPropertySteps && (
                    <button
                      onClick={handleAddProperty}
                      className="ml-auto px-6 py-2 bg-green-500 text-white rounded-lg font-semibold hover:bg-green-600 transition-colors"
                    >
                      Áâ©‰ª∂„ÇíËøΩÂä†
                    </button>
                  )}
                </div>
              </div>
            </div>
          )}

          {/* üè† Áâ©‰ª∂Á∑®ÈõÜ„É¢„Éº„ÉÄ„É´ */}
          {showEditProperty && editingProperty && (
            <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
              <div className="bg-white rounded-2xl shadow-2xl w-full max-w-3xl max-h-[90vh] overflow-y-auto">
                <div className="sticky top-0 bg-white border-b p-6 z-10">
                  <div className="flex items-center justify-between">
                    <div>
                      <h3 className="text-2xl font-bold text-gray-800">Áâ©‰ª∂„ÇíÁ∑®ÈõÜ</h3>
                      <p className="text-sm text-gray-500 mt-1">
                        „Çπ„ÉÜ„ÉÉ„Éó {editPropertyStep} / {totalPropertySteps}
                      </p>
                    </div>
                    <button onClick={() => { setShowEditProperty(false); setEditPropertyStep(1); }} className="text-gray-400 hover:text-gray-600">
                      <X className="w-6 h-6" />
                    </button>
                  </div>
                  <div className="mt-4 flex space-x-2">
                    {[1, 2, 3, 4].map(step => (
                      <div
                        key={step}
                        className={`flex-1 h-2 rounded-full ${step <= editPropertyStep ? 'bg-orange-500' : 'bg-gray-200'}`}
                      />
                    ))}
                  </div>
                </div>

                <div className="p-6 space-y-6">
                  {editPropertyStep === 1 && (
                    <div className="space-y-4">
                      <h4 className="text-lg font-bold text-gray-800">Âü∫Êú¨ÊÉÖÂ†±</h4>
                      <div>
                        <label className="block text-sm font-semibold text-gray-700 mb-2">Áâ©‰ª∂Á®ÆÂà• *</label>
                        <select
                          value={editingProperty.propertyType}
                          onChange={(e) => setEditingProperty({ ...editingProperty, propertyType: e.target.value })}
                          className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                        >
                          <option>„Éû„É≥„Ç∑„Éß„É≥</option>
                          <option>‰∏ÄÊà∏Âª∫„Å¶</option>
                          <option>ÂúüÂú∞</option>
                          <option>Â∫óËàó„Éª‰∫ãÂãôÊâÄ</option>
                        </select>
                      </div>
                      <div>
                        <label className="block text-sm font-semibold text-gray-700 mb-2">Áâ©‰ª∂Âêç *</label>
                        <input
                          type="text"
                          value={editingProperty.propertyName}
                          onChange={(e) => setEditingProperty({ ...editingProperty, propertyName: e.target.value })}
                          className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                        />
                      </div>
                    </div>
                  )}

                  {editPropertyStep === 2 && (
                    <div className="space-y-4">
                      <h4 className="text-lg font-bold text-gray-800">ÊâÄÂú®Âú∞ÊÉÖÂ†±</h4>
                      <div>
                        <label className="block text-sm font-semibold text-gray-700 mb-2">‰ΩèÊâÄ *</label>
                        <input
                          type="text"
                          value={editingProperty.address}
                          onChange={(e) => setEditingProperty({ ...editingProperty, address: e.target.value })}
                          className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                        />
                      </div>
                      {editingProperty.propertyType === '„Éû„É≥„Ç∑„Éß„É≥' && (
                        <div>
                          <label className="block text-sm font-semibold text-gray-700 mb-2">ÈÉ®Â±ãÁï™Âè∑</label>
                          <input
                            type="text"
                            value={editingProperty.roomNumber}
                            onChange={(e) => setEditingProperty({ ...editingProperty, roomNumber: e.target.value })}
                            className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                          />
                        </div>
                      )}
                    </div>
                  )}

                  {editPropertyStep === 3 && (
                    <div className="space-y-4">
                      <h4 className="text-lg font-bold text-gray-800">Áâ©‰ª∂Ë©≥Á¥∞</h4>
                      <div>
                        <label className="block text-sm font-semibold text-gray-700 mb-2">Âª∫Áâ©ÊßãÈÄ†</label>
                        <select
                          value={editingProperty.buildingStructure}
                          onChange={(e) => setEditingProperty({ ...editingProperty, buildingStructure: e.target.value })}
                          className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                        >
                          <option value="">ÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ</option>
                          <option>Êú®ÈÄ†</option>
                          <option>ÈâÑÈ™®ÈÄ†</option>
                          <option>RCÈÄ†</option>
                          <option>SRCÈÄ†</option>
                        </select>
                      </div>
                      <div>
                        <label className="block text-sm font-semibold text-gray-700 mb-2">ÁØâÂπ¥</label>
                        <input
                          type="text"
                          value={editingProperty.buildYear}
                          onChange={(e) => setEditingProperty({ ...editingProperty, buildYear: e.target.value })}
                          className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                        />
                      </div>
                      <div className="grid grid-cols-2 gap-4">
                        <div>
                          <label className="block text-sm font-semibold text-gray-700 mb-2">ÂúüÂú∞Èù¢Á©ç („é°)</label>
                          <input
                            type="text"
                            value={editingProperty.landArea}
                            onChange={(e) => setEditingProperty({ ...editingProperty, landArea: e.target.value })}
                            className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                          />
                        </div>
                        <div>
                          <label className="block text-sm font-semibold text-gray-700 mb-2">Âª∫Áâ©Èù¢Á©ç („é°)</label>
                          <input
                            type="text"
                            value={editingProperty.buildingArea}
                            onChange={(e) => setEditingProperty({ ...editingProperty, buildingArea: e.target.value })}
                            className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                          />
                        </div>
                      </div>
                    </div>
                  )}

                  {editPropertyStep === 4 && (
                    <div className="space-y-4">
                      <h4 className="text-lg font-bold text-gray-800">ÂÇôËÄÉ</h4>
                      <div>
                        <label className="block text-sm font-semibold text-gray-700 mb-2">ÂÇôËÄÉ„Éª„É°„É¢</label>
                        <textarea
                          value={editingProperty.notes}
                          onChange={(e) => setEditingProperty({ ...editingProperty, notes: e.target.value })}
                          rows="6"
                          className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                        />
                      </div>
                    </div>
                  )}
                </div>

                <div className="sticky bottom-0 bg-gray-50 px-6 py-4 flex justify-between border-t">
                  {editPropertyStep > 1 && (
                    <button
                      onClick={() => setEditPropertyStep(editPropertyStep - 1)}
                      className="px-6 py-2 border border-gray-300 rounded-lg font-semibold text-gray-700 hover:bg-gray-100 transition-colors"
                    >
                      Êàª„Çã
                    </button>
                  )}
                  {editPropertyStep < totalPropertySteps && (
                    <button
                      onClick={() => setEditPropertyStep(editPropertyStep + 1)}
                      className="ml-auto px-6 py-2 bg-orange-500 text-white rounded-lg font-semibold hover:bg-orange-600 transition-colors"
                    >
                      Ê¨°„Å∏
                    </button>
                  )}
                  {editPropertyStep === totalPropertySteps && (
                    <button
                      onClick={handleEditProperty}
                      className="ml-auto px-6 py-2 bg-green-500 text-white rounded-lg font-semibold hover:bg-green-600 transition-colors"
                    >
                      Êõ¥Êñ∞
                    </button>
                  )}
                </div>
              </div>
            </div>
          )}

          {/* Â•ëÁ¥ÑËøΩÂä†„É¢„Éº„ÉÄ„É´Ôºà7„Çπ„ÉÜ„ÉÉ„ÉóÔºâ */}
          {showNewContract && (
            <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4 overflow-y-auto">
              <div className="bg-white rounded-2xl shadow-2xl w-full max-w-4xl my-8">
                <div className="sticky top-0 bg-white border-b p-6 z-10 rounded-t-2xl">
                  <div className="flex items-center justify-between">
                    <div>
                      <h3 className="text-2xl font-bold text-gray-800">Â•ëÁ¥Ñ„ÇíËøΩÂä†</h3>
                      <p className="text-sm text-gray-500 mt-1">„Çπ„ÉÜ„ÉÉ„Éó {currentStep} / {totalSteps}</p>
                    </div>
                    <button onClick={() => { setShowNewContract(false); setCurrentStep(1); }} className="text-gray-400 hover:text-gray-600">
                      <X className="w-6 h-6" />
                    </button>
                  </div>
                  <div className="mt-4 flex space-x-1">
                    {[1, 2, 3, 4, 5, 6, 7].map(step => (
                      <div key={step} className={`flex-1 h-2 rounded-full ${step <= currentStep ? 'bg-orange-500' : 'bg-gray-200'}`} />
                    ))}
                  </div>
                </div>

                <div className="p-6 space-y-6 max-h-[60vh] overflow-y-auto">
                  {currentStep === 1 && (
                    <div className="space-y-4">
                      <h4 className="text-lg font-bold text-gray-800">Áâ©‰ª∂ÊÉÖÂ†±</h4>
                      <div>
                        <label className="block text-sm font-semibold text-gray-700 mb-2">Êó¢Â≠òÁâ©‰ª∂„Åã„ÇâÈÅ∏ÊäûÔºà‰ªªÊÑèÔºâ</label>
                        <select
                          value={newContract.propertyId}
                          onChange={(e) => {
                            const propId = Number(e.target.value);
                            const prop = properties.find(p => p.id === propId);
                            if (prop) {
                              setNewContract({
                                ...newContract,
                                propertyId: propId,
                                propertyType: prop.propertyType,
                                address: prop.address,
                                propertyName: prop.propertyName,
                                roomNumber: prop.roomNumber || ''
                              });
                            } else {
                              setNewContract({ ...newContract, propertyId: '' });
                            }
                          }}
                          className="w-full px-4 py-2 border border-gray-300 rounded-lg"
                        >
                          <option value="">Êñ∞Ë¶èÁâ©‰ª∂„Å®„Åó„Å¶ÂÖ•Âäõ</option>
                          {properties.map(prop => (
                            <option key={prop.id} value={prop.id}>
                              {prop.propertyName} {prop.roomNumber} - {prop.address}
                            </option>
                          ))}
                        </select>
                      </div>
                      <div>
                        <label className="block text-sm font-semibold text-gray-700 mb-2">Áâ©‰ª∂Á®ÆÂà• *</label>
                        <select
                          value={newContract.propertyType}
                          onChange={(e) => setNewContract({ ...newContract, propertyType: e.target.value })}
                          className="w-full px-4 py-2 border border-gray-300 rounded-lg"
                        >
                          <option>„Éû„É≥„Ç∑„Éß„É≥</option>
                          <option>‰∏ÄÊà∏Âª∫„Å¶</option>
                          <option>ÂúüÂú∞</option>
                        </select>
                      </div>
                      <div>
                        <label className="block text-sm font-semibold text-gray-700 mb-2">‰ΩèÊâÄ *</label>
                        <input
                          type="text"
                          value={newContract.address}
                          onChange={(e) => setNewContract({ ...newContract, address: e.target.value })}
                          className="w-full px-4 py-2 border border-gray-300 rounded-lg"
                        />
                      </div>
                      {newContract.propertyType === '„Éû„É≥„Ç∑„Éß„É≥' && (
                        <>
                          <div>
                            <label className="block text-sm font-semibold text-gray-700 mb-2">Áâ©‰ª∂Âêç</label>
                            <input
                              type="text"
                              value={newContract.propertyName}
                              onChange={(e) => setNewContract({ ...newContract, propertyName: e.target.value })}
                              className="w-full px-4 py-2 border border-gray-300 rounded-lg"
                            />
                          </div>
                          <div>
                            <label className="block text-sm font-semibold text-gray-700 mb-2">ÈÉ®Â±ãÁï™Âè∑</label>
                            <input
                              type="text"
                              value={newContract.roomNumber}
                              onChange={(e) => setNewContract({ ...newContract, roomNumber: e.target.value })}
                              className="w-full px-4 py-2 border border-gray-300 rounded-lg"
                            />
                          </div>
                        </>
                      )}
                    </div>
                  )}

                  {currentStep === 2 && (
                    <div className="space-y-4">
                      <h4 className="text-lg font-bold text-gray-800">ÂèñÂºïÊÉÖÂ†±</h4>
                      <div>
                        <label className="block text-sm font-semibold text-gray-700 mb-2">ÂèñÂºïÁ®ÆÂà• *</label>
                        <select
                          value={newContract.dealType}
                          onChange={(e) => setNewContract({ ...newContract, dealType: e.target.value })}
                          className="w-full px-4 py-2 border border-gray-300 rounded-lg"
                        >
                          <option>‰ª≤‰ªã</option>
                          <option>Ë≤∑Âèñ</option>
                          <option>Â£≤Âç¥</option>
                        </select>
                      </div>
                      <div className="grid grid-cols-2 gap-4">
                        <div>
                          <label className="block text-sm font-semibold text-gray-700 mb-2">Ë≤∑‰∏ªÂêç</label>
                          <input
                            type="text"
                            value={newContract.buyerName}
                            onChange={(e) => setNewContract({ ...newContract, buyerName: e.target.value })}
                            className="w-full px-4 py-2 border border-gray-300 rounded-lg"
                          />
                        </div>
                        <div>
                          <label className="block text-sm font-semibold text-gray-700 mb-2">Ë≤∑‰∏ªÂêçÔºà„Ç´„ÉäÔºâ</label>
                          <input
                            type="text"
                            value={newContract.buyerKana}
                            onChange={(e) => setNewContract({ ...newContract, buyerKana: e.target.value })}
                            className="w-full px-4 py-2 border border-gray-300 rounded-lg"
                          />
                        </div>
                      </div>
                      <div className="grid grid-cols-2 gap-4">
                        <div>
                          <label className="block text-sm font-semibold text-gray-700 mb-2">Â£≤‰∏ªÂêç</label>
                          <input
                            type="text"
                            value={newContract.sellerName}
                            onChange={(e) => setNewContract({ ...newContract, sellerName: e.target.value })}
                            className="w-full px-4 py-2 border border-gray-300 rounded-lg"
                          />
                        </div>
                        <div>
                          <label className="block text-sm font-semibold text-gray-700 mb-2">Â£≤‰∏ªÂêçÔºà„Ç´„ÉäÔºâ</label>
                          <input
                            type="text"
                            value={newContract.sellerKana}
                            onChange={(e) => setNewContract({ ...newContract, sellerKana: e.target.value })}
                            className="w-full px-4 py-2 border border-gray-300 rounded-lg"
                          />
                        </div>
                      </div>
                    </div>
                  )}

                  {currentStep === 3 && (
                    <div className="space-y-4">
                      <h4 className="text-lg font-bold text-gray-800">ÈáëÈ°çÊÉÖÂ†±</h4>
                      <div>
                        <label className="block text-sm font-semibold text-gray-700 mb-2">Áâ©‰ª∂‰æ°Ê†ºÔºàÂÜÜÔºâ</label>
                        <input
                          type="number"
                          value={newContract.propertyPrice}
                          onChange={(e) => setNewContract({ ...newContract, propertyPrice: e.target.value })}
                          className="w-full px-4 py-2 border border-gray-300 rounded-lg"
                        />
                      </div>
                      <div>
                        <label className="block text-sm font-semibold text-gray-700 mb-2">ÊÆãÂÇµÂãôÔºàÂÜÜÔºâ</label>
                        <input
                          type="number"
                          value={newContract.outstandingDebt}
                          onChange={(e) => setNewContract({ ...newContract, outstandingDebt: e.target.value })}
                          className="w-full px-4 py-2 border border-gray-300 rounded-lg"
                        />
                      </div>
                    </div>
                  )}

                  {currentStep === 4 && (
                    <div className="space-y-4">
                      <h4 className="text-lg font-bold text-gray-800">ÁâπË®ò‰∫ãÈ†Ö</h4>
                      <div className="space-y-3">
                        <label className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            checked={newContract.loanUsage}
                            onChange={(e) => setNewContract({ ...newContract, loanUsage: e.target.checked })}
                            className="w-5 h-5"
                          />
                          <span>„É≠„Éº„É≥Âà©Áî®</span>
                        </label>
                        <label className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            checked={newContract.mortgageRemoval}
                            onChange={(e) => setNewContract({ ...newContract, mortgageRemoval: e.target.checked })}
                            className="w-5 h-5"
                          />
                          <span>ÊäµÂΩìÊ®©ÊäπÊ∂à</span>
                        </label>
                        <label className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            checked={newContract.renovation}
                            onChange={(e) => setNewContract({ ...newContract, renovation: e.target.checked })}
                            className="w-5 h-5"
                          />
                          <span>„É™„Éï„Ç©„Éº„É†</span>
                        </label>
                      </div>
                    </div>
                  )}

                  {currentStep === 5 && (
                    <div className="space-y-4">
                      <h4 className="text-lg font-bold text-gray-800">Êó•Á®ã</h4>
                      <div>
                        <label className="block text-sm font-semibold text-gray-700 mb-2">Â•ëÁ¥ÑÊó•</label>
                        <input
                          type="date"
                          value={newContract.contractDate}
                          onChange={(e) => setNewContract({ ...newContract, contractDate: e.target.value })}
                          className="w-full px-4 py-2 border border-gray-300 rounded-lg"
                        />
                      </div>
                      <div>
                        <label className="block text-sm font-semibold text-gray-700 mb-2">Ê±∫Ê∏àÊúüÈôê</label>
                        <input
                          type="date"
                          value={newContract.settlementDeadline}
                          onChange={(e) => setNewContract({ ...newContract, settlementDeadline: e.target.value })}
                          className="w-full px-4 py-2 border border-gray-300 rounded-lg"
                        />
                      </div>
                    </div>
                  )}

                  {currentStep === 6 && (
                    <div className="space-y-4">
                      <h4 className="text-lg font-bold text-gray-800">ÊãÖÂΩìËÄÖÊÉÖÂ†±</h4>
                      <div>
                        <label className="block text-sm font-semibold text-gray-700 mb-2">Âñ∂Ê•≠ÊâÄ</label>
                        <select
                          value={newContract.officeId}
                          onChange={(e) => setNewContract({ ...newContract, officeId: e.target.value })}
                          className="w-full px-4 py-2 border border-gray-300 rounded-lg"
                        >
                          <option value="">ÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ</option>
                          {offices.map(office => (
                            <option key={office.id} value={office.id}>{office.name}</option>
                          ))}
                        </select>
                      </div>
                      <div>
                        <label className="block text-sm font-semibold text-gray-700 mb-2">ÊãÖÂΩìËÄÖ</label>
                        <select
                          value={newContract.assigneeId}
                          onChange={(e) => setNewContract({ ...newContract, assigneeId: e.target.value })}
                          className="w-full px-4 py-2 border border-gray-300 rounded-lg"
                        >
                          <option value="">ÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ</option>
                          {staff.map(member => (
                            <option key={member.id} value={member.id}>{member.name}</option>
                          ))}
                        </select>
                      </div>
                    </div>
                  )}

                  {currentStep === 7 && (
                    <div className="space-y-4">
                      <h4 className="text-lg font-bold text-gray-800">Á¢∫Ë™ç</h4>
                      <div className="bg-gray-50 p-4 rounded-lg space-y-2 text-sm">
                        <div><span className="font-semibold">Áâ©‰ª∂Á®ÆÂà•:</span> {newContract.propertyType}</div>
                        <div><span className="font-semibold">‰ΩèÊâÄ:</span> {newContract.address}</div>
                        <div><span className="font-semibold">ÂèñÂºïÁ®ÆÂà•:</span> {newContract.dealType}</div>
                        <div><span className="font-semibold">Ë≤∑‰∏ª:</span> {newContract.buyerName}</div>
                        <div><span className="font-semibold">Â£≤‰∏ª:</span> {newContract.sellerName}</div>
                        <div><span className="font-semibold">Â•ëÁ¥ÑÊó•:</span> {newContract.contractDate}</div>
                        <div><span className="font-semibold">Ê±∫Ê∏àÊúüÈôê:</span> {newContract.settlementDeadline}</div>
                      </div>
                    </div>
                  )}
                </div>

                <div className="sticky bottom-0 bg-gray-50 px-6 py-4 flex justify-between border-t rounded-b-2xl">
                  {currentStep > 1 && (
                    <button
                      onClick={() => setCurrentStep(currentStep - 1)}
                      className="px-6 py-2 border border-gray-300 rounded-lg font-semibold text-gray-700 hover:bg-gray-100"
                    >
                      Êàª„Çã
                    </button>
                  )}
                  {currentStep < totalSteps && (
                    <button
                      onClick={() => setCurrentStep(currentStep + 1)}
                      className="ml-auto px-6 py-2 bg-orange-500 text-white rounded-lg font-semibold hover:bg-orange-600"
                    >
                      Ê¨°„Å∏
                    </button>
                  )}
                  {currentStep === totalSteps && (
                    <button
                      onClick={handleAddContract}
                      className="ml-auto px-6 py-2 bg-green-500 text-white rounded-lg font-semibold hover:bg-green-600"
                    >
                      Â•ëÁ¥Ñ„ÇíËøΩÂä†
                    </button>
                  )}
                </div>
              </div>
            </div>
          )}

          {/* Â•ëÁ¥ÑÁ∑®ÈõÜ„É¢„Éº„ÉÄ„É´ */}
          {showEditContract && editingContract && (
            <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4 overflow-y-auto">
              <div className="bg-white rounded-2xl shadow-2xl w-full max-w-4xl my-8">
                <div className="sticky top-0 bg-white border-b p-6 z-10 rounded-t-2xl">
                  <div className="flex items-center justify-between">
                    <h3 className="text-2xl font-bold text-gray-800">Â•ëÁ¥Ñ„ÇíÁ∑®ÈõÜ</h3>
                    <button onClick={() => { setShowEditContract(false); setEditStep(1); }} className="text-gray-400 hover:text-gray-600">
                      <X className="w-6 h-6" />
                    </button>
                  </div>
                </div>

                <div className="p-6 space-y-6">
                  <div className="space-y-4">
                    <div>
                      <label className="block text-sm font-semibold text-gray-700 mb-2">‰ΩèÊâÄ *</label>
                      <input
                        type="text"
                        value={editingContract.address}
                        onChange={(e) => setEditingContract({ ...editingContract, address: e.target.value })}
                        className="w-full px-4 py-2 border border-gray-300 rounded-lg"
                      />
                    </div>
                    <div>
                      <label className="block text-sm font-semibold text-gray-700 mb-2">ÂèñÂºïÁ®ÆÂà• *</label>
                      <select
                        value={editingContract.dealType}
                        onChange={(e) => setEditingContract({ ...editingContract, dealType: e.target.value })}
                        className="w-full px-4 py-2 border border-gray-300 rounded-lg"
                      >
                        <option>‰ª≤‰ªã</option>
                        <option>Ë≤∑Âèñ</option>
                        <option>Â£≤Âç¥</option>
                      </select>
                    </div>
                    <div className="grid grid-cols-2 gap-4">
                      <div>
                        <label className="block text-sm font-semibold text-gray-700 mb-2">Ë≤∑‰∏ªÂêç</label>
                        <input
                          type="text"
                          value={editingContract.buyerName}
                          onChange={(e) => setEditingContract({ ...editingContract, buyerName: e.target.value })}
                          className="w-full px-4 py-2 border border-gray-300 rounded-lg"
                        />
                      </div>
                      <div>
                        <label className="block text-sm font-semibold text-gray-700 mb-2">Â£≤‰∏ªÂêç</label>
                        <input
                          type="text"
                          value={editingContract.sellerName}
                          onChange={(e) => setEditingContract({ ...editingContract, sellerName: e.target.value })}
                          className="w-full px-4 py-2 border border-gray-300 rounded-lg"
                        />
                      </div>
                    </div>
                  </div>
                </div>

                <div className="sticky bottom-0 bg-gray-50 px-6 py-4 flex justify-end space-x-3 border-t rounded-b-2xl">
                  <button
                    onClick={() => setShowEditContract(false)}
                    className="px-6 py-2 border border-gray-300 rounded-lg font-semibold text-gray-700 hover:bg-gray-100"
                  >
                    „Ç≠„É£„É≥„Çª„É´
                  </button>
                  <button
                    onClick={handleEditContractSave}
                    className="px-6 py-2 bg-green-500 text-white rounded-lg font-semibold hover:bg-green-600"
                  >
                    Êõ¥Êñ∞
                  </button>
                </div>
              </div>
            </div>
          )}

          {showPaymentDetail && (
            <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
              <div className="bg-white rounded-2xl shadow-2xl w-full max-w-2xl">
                <div className="border-b p-6">
                  <div className="flex items-center justify-between">
                    <h3 className="text-2xl font-bold text-gray-800">{showPaymentDetail.title}</h3>
                    <button onClick={() => setShowPaymentDetail(null)} className="text-gray-400">
                      <X className="w-6 h-6" />
                    </button>
                  </div>
                </div>
                <div className="p-6">
                  {(() => {
                    const contract = contracts.find(c => c.id === showPaymentDetail.contractId);
                    return (
                      <div className="space-y-6">
                        {contract && (
                          <div className="bg-gray-50 p-4 rounded-lg">
                            <div className="font-semibold text-gray-700 mb-2">Â•ëÁ¥ÑÊÉÖÂ†±</div>
                            <div className="text-sm text-gray-600">
                              {contract.propertyName} {contract.roomNumber}
                            </div>
                            <div className="text-sm text-gray-600">{contract.address}</div>
                          </div>
                        )}

                        <div className="grid grid-cols-2 gap-6">
                          <div>
                            <div className="text-gray-600 mb-1">„Çø„Çπ„ÇØÁ®ÆÂà•</div>
                            <div className={`inline-block px-4 py-2 rounded-lg font-semibold ${
                              showPaymentDetail.type === 'ÂÖ•Èáë' ? 'bg-green-100 text-green-600' : 'bg-red-100 text-red-600'
                            }`}>
                              {showPaymentDetail.type}
                            </div>
                          </div>
                          <div>
                            <div className="text-gray-600 mb-1">ÊúüÊó•</div>
                            <div className="font-semibold text-gray-800">{showPaymentDetail.dueDate}</div>
                          </div>
                        </div>

                        {showPaymentDetail.amount && (
                          <div className="bg-blue-50 p-6 rounded-lg">
                            <div className="text-gray-600 mb-2">ÈáëÈ°ç</div>
                            <div className="text-3xl font-bold text-blue-600">
                              ¬•{Number(showPaymentDetail.amount).toLocaleString()}
                            </div>
                          </div>
                        )}

                        {(showPaymentDetail.purpose || showPaymentDetail.paymentMethod || showPaymentDetail.receiptDelivery) && (
                          <div className="border-t pt-6">
                            <div className="grid grid-cols-2 gap-4">
                              {showPaymentDetail.purpose && (
                                <div>
                                  <div className="text-gray-600 mb-1">Áî®ÈÄî</div>
                                  <div className="font-semibold text-gray-800">{showPaymentDetail.purpose}</div>
                                </div>
                              )}
                              {showPaymentDetail.paymentMethod && (
                                <div>
                                  <div className="text-gray-600 mb-1">ÊîØÊâïÊñπÊ≥ï</div>
                                  <div className="font-semibold text-gray-800">{showPaymentDetail.paymentMethod}</div>
                                </div>
                              )}
                              {showPaymentDetail.receiptDelivery && (
                                <div>
                                  <div className="text-gray-600 mb-1">È†òÂèéÊõ∏ÈÖçÈÄÅ</div>
                                  <div className="font-semibold text-gray-800">{showPaymentDetail.receiptDelivery}</div>
                                </div>
                              )}
                            </div>
                          </div>
                        )}

                        <div className="flex justify-end space-x-3 pt-4 border-t border-gray-200">
                          {!showPaymentDetail.paymentCompleted && (
                            <button
                              onClick={() => handlePaymentComplete(showPaymentDetail.id, showPaymentDetail.type)}
                              className={`${showPaymentDetail.type === 'ÂÖ•Èáë' ? 'bg-green-500 hover:bg-green-600' : 'bg-red-500 hover:bg-red-600'} px-6 py-3 rounded-lg font-semibold transition-all flex items-center space-x-2 text-white`}
                            >
                              <Check className="w-5 h-5" />
                              <span>ÁµåÁêÜ{showPaymentDetail.type === 'ÂÖ•Èáë' ? 'ÂÖ•Èáë' : 'ÊîØÊâï„ÅÑ'}Á¢∫Ë™ç</span>
                            </button>
                          )}
                          {showPaymentDetail.paymentCompleted && (
                            <div className="px-6 py-3 bg-gray-100 text-gray-600 rounded-lg font-semibold flex items-center space-x-2">
                              <Check className="w-5 h-5" />
                              <span>Á¢∫Ë™çÊ∏à„Åø</span>
                            </div>
                          )}
                          <button
                            onClick={() => setShowPaymentDetail(null)}
                            className="px-6 py-2 bg-gray-500 text-white rounded-lg font-semibold hover:bg-gray-600 transition-colors"
                          >
                            Èñâ„Åò„Çã
                          </button>
                        </div>
                      </div>
                    );
                  })()}
                </div>
              </div>
            </div>
          )}

          {showTaskDetail && (
            <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
              <div className="bg-white rounded-2xl shadow-2xl w-full max-w-2xl">
                <div className="border-b p-6">
                  <div className="flex items-center justify-between">
                    <h3 className="text-2xl font-bold text-gray-800">{showTaskDetail.title}</h3>
                    <button onClick={() => setShowTaskDetail(null)} className="text-gray-400">
                      <X className="w-6 h-6" />
                    </button>
                  </div>
                </div>
                <div className="p-6">
                  <div className="space-y-4">
                    <div className="grid grid-cols-2 gap-4">
                      <div>
                        <label className="block text-sm font-semibold text-gray-700 mb-1">„Çø„Çπ„ÇØÁ®ÆÂà•</label>
                        <div className="text-gray-800">{showTaskDetail.type}</div>
                      </div>
                      <div>
                        <label className="block text-sm font-semibold text-gray-700 mb-1">ÊúüÊó•</label>
                        <div className="text-gray-800">{showTaskDetail.dueDate}</div>
                      </div>
                    </div>
                    <div className="flex space-x-3 pt-4">
                      <button onClick={() => { updateTaskStatus(showTaskDetail.id, 'in-progress'); setShowTaskDetail(null); }} className="flex-1 bg-blue-500 text-white py-3 rounded-lg font-semibold">ÊãÖÂΩìËÄÖÁ¢∫Ë™ç</button>
                      <button onClick={() => { updateTaskStatus(showTaskDetail.id, 'done'); setShowTaskDetail(null); }} className="flex-1 bg-green-500 text-white py-3 rounded-lg font-semibold">ÂÆå‰∫Ü</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          )}

          {showAddOffice && (
            <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
              <div className="bg-white rounded-2xl shadow-2xl w-full max-w-md">
                <div className="border-b p-6">
                  <div className="flex items-center justify-between">
                    <h3 className="text-2xl font-bold text-gray-800">Âñ∂Ê•≠ÊâÄ„ÇíËøΩÂä†</h3>
                    <button onClick={() => setShowAddOffice(false)} className="text-gray-400">
                      <X className="w-6 h-6" />
                    </button>
                  </div>
                </div>
                <div className="p-6 space-y-4">
                  <div>
                    <label className="block text-sm font-semibold text-gray-700 mb-2">Âñ∂Ê•≠ÊâÄÂêç *</label>
                    <input type="text" value={newOffice.name} onChange={(e) => setNewOffice({ ...newOffice, name: e.target.value })} className="w-full px-4 py-2 border rounded-lg" />
                  </div>
                  <div>
                    <label className="block text-sm font-semibold text-gray-700 mb-2">‰ΩèÊâÄ *</label>
                    <input type="text" value={newOffice.address} onChange={(e) => setNewOffice({ ...newOffice, address: e.target.value })} className="w-full px-4 py-2 border rounded-lg" />
                  </div>
                  <div className="flex justify-end space-x-3 pt-4">
                    <button onClick={() => setShowAddOffice(false)} className="px-6 py-2 border rounded-lg text-gray-700">„Ç≠„É£„É≥„Çª„É´</button>
                    <button onClick={handleAddOffice} className="px-6 py-2 bg-orange-500 text-white rounded-lg font-semibold">ËøΩÂä†</button>
                  </div>
                </div>
              </div>
            </div>
          )}

          {showAddStaff && (
            <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
              <div className="bg-white rounded-2xl shadow-2xl w-full max-w-md">
                <div className="border-b p-6">
                  <div className="flex items-center justify-between">
                    <h3 className="text-2xl font-bold text-gray-800">„Çπ„Çø„ÉÉ„Éï„ÇíËøΩÂä†</h3>
                    <button onClick={() => setShowAddStaff(false)} className="text-gray-400">
                      <X className="w-6 h-6" />
                    </button>
                  </div>
                </div>
                <div className="p-6 space-y-4">
                  <div>
                    <label className="block text-sm font-semibold text-gray-700 mb-2">ÂêçÂâç *</label>
                    <input type="text" value={newStaff.name} onChange={(e) => setNewStaff({ ...newStaff, name: e.target.value })} className="w-full px-4 py-2 border rounded-lg" />
                  </div>
                  <div>
                    <label className="block text-sm font-semibold text-gray-700 mb-2">Âñ∂Ê•≠ÊâÄ *</label>
                    <select value={newStaff.officeId} onChange={(e) => setNewStaff({ ...newStaff, officeId: e.target.value })} className="w-full px-4 py-2 border rounded-lg">
                      <option value="">ÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ</option>
                      {offices.map(office => (
                        <option key={office.id} value={office.id}>{office.name}</option>
                      ))}
                    </select>
                  </div>
                  <div>
                    <label className="block text-sm font-semibold text-gray-700 mb-2">ÂΩπËÅ∑</label>
                    <select value={newStaff.role} onChange={(e) => setNewStaff({ ...newStaff, role: e.target.value })} className="w-full px-4 py-2 border rounded-lg">
                      <option value="Âñ∂Ê•≠ÊãÖÂΩì">Âñ∂Ê•≠ÊãÖÂΩì</option>
                      <option value="ÊâÄÈï∑">ÊâÄÈï∑</option>
                      <option value="ÁµåÁêÜ">ÁµåÁêÜ</option>
                    </select>
                  </div>
                  <div className="flex justify-end space-x-3 pt-4">
                    <button onClick={() => setShowAddStaff(false)} className="px-6 py-2 border rounded-lg text-gray-700">„Ç≠„É£„É≥„Çª„É´</button>
                    <button onClick={handleAddStaff} className="px-6 py-2 bg-blue-500 text-white rounded-lg font-semibold">ËøΩÂä†</button>
                  </div>
                </div>
              </div>
            </div>
          )}
        </div>
      );
    };

    ReactDOM.createRoot(document.getElementById('root')).render(<RealEstateTaskManager />);
  </script>
</body>
</html>
